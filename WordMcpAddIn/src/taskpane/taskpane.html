<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Word MCP Add-in</title>
  <!-- Office JavaScript API -->
  <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  
  <!-- For the webpack build system - don't include script tag for taskpane.js -->
  <!-- Webpack will automatically inject the bundled scripts -->
</head>

<body>
  <div id="app">
    <!-- Connection Status Bar -->
    <div class="status-bar">
      <div class="status-indicator">
        <span id="connectionStatus">Disconnected</span>
      </div>
    </div>

    <!-- Reconnect Panel (shown when disconnected) -->
    <div id="reconnectPanel" class="reconnect-panel">
      <p>Not connected to the WebSocket server. Please connect to enable document operations.</p>
      <button id="reconnectBtn" class="primary-button">Connect</button>
    </div>

    <!-- Main Content (hidden when disconnected) -->
    <div id="mainContent" class="main-content">
      <!-- Document Operations Section -->
      <section class="card">
        <h2>Document Operations</h2>
        <div class="button-group">
          <button id="snapshotBtn" class="action-button">
            <span>Get Snapshot</span>
          </button>
          <button id="syncBtn" class="action-button">
            <span>Sync Document</span>
          </button>
        </div>
      </section>

      <!-- Patch Editor Section -->
      <section class="card">
        <h2>Document Patch</h2>
        <div class="textarea-container">
          <textarea id="patchTextarea" placeholder="Enter JSON patch here..." spellcheck="false"></textarea>
        </div>
        <div class="button-group">
          <button id="applyPatchBtn" class="action-button primary">
            <span>Apply Patch</span>
          </button>
          <button id="clearPatchBtn" class="action-button">
            <span>Clear</span>
          </button>
          <button id="sampleBtn" class="action-button">
            <span>Load Sample</span>
          </button>
        </div>
      </section>

      <!-- Result Display Section -->
      <section class="card">
        <h2>Result</h2>
        <pre id="result" class="result-display">No data to display</pre>
      </section>
    </div>
  </div>
</body>
</html>