<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Oppice AI Assistant</title>

    <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
    <link rel="stylesheet" href="taskpane.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Segoe+UI:wght@400;600&display=swap" />
  </head>

  <body class="ms-font-m">
    <div class="container">
      <!-- Connection status -->
      <div id="connectionPanel">
        <div id="connectionStatus">Connecting to server...</div>
      </div>

      <!-- Reconnect panel -->
      <div id="reconnectPanel" style="display: none;">
        <p>Failed to connect to the server. Please make sure it's running.</p>
        <button id="reconnectBtn">Reconnect</button>
      </div>

      <!-- Main UI -->
      <div id="mainContent">
        <h2>📎 Oppice AI Assistant</h2>

        <div class="section">
          <h3>📘 Read by Block ID</h3>
          <input id="readId" placeholder="e.g. para-0" />
          <button id="readBtn">Read</button>
        </div>

        <div class="section">
          <h3>🔎 Search by Keyword</h3>
          <input id="searchKw" placeholder="e.g. introduction" />
          <button id="searchBtn">Search</button>
        </div>

        <div class="section">
          <h3>✏️ Edit Paragraph</h3>
          <input id="editId" placeholder="Block ID" style="width: 120px;" />
          <input id="editTxt" placeholder="New paragraph text" style="width: 280px;" />
          <button id="editBtn">Apply Edit</button>
        </div>

        <hr />

        <div class="section">
          <h4>📝 Result</h4>
          <pre id="result"></pre>
        </div>
      </div>
    </div>
  </body>
</html>
