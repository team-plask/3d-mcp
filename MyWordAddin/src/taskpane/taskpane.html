<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Word Content Assistant</title> <!-- Title 변경 -->

    <!-- Office JavaScript API -->
    <script type="text/javascript" src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

    <!-- Fluent UI 스타일 (기존) -->
    <link rel="stylesheet" href="https://res-1.cdn.office.net/files/fabric-cdn-prod_20230815.002/office-ui-fabric-core/11.1.0/css/fabric.min.css"/>

    <!-- Add-in 스타일 (기존) -->
    <link href="taskpane.css" rel="stylesheet" type="text/css" />

    <!-- 추가: Diff 컨테이너 스타일 (taskpane.css에 넣는 것이 더 좋음) -->
    <style>
        #diff-container {
            border: 1px solid #eee; /* 테두리 스타일 변경 */
            padding: 10px;
            margin-bottom: 15px; /* 버튼과의 간격 */
            min-height: 150px;   /* 최소 높이 설정 */
            font-family: Consolas, monaco, monospace; /* 고정폭 글꼴 */
            white-space: pre-wrap;   /* 줄바꿈 및 공백 유지 */
            background-color: #f9f9f9; /* 배경색 추가 */
            overflow-y: auto;      /* 내용 길어지면 스크롤 */
            max-height: 400px;     /* 최대 높이 제한 */
        }
        /* diff-match-patch 기본 스타일 조정 (선택 사항) */
        #diff-container ins {
             background-color: #e6ffe6; /* 연한 녹색 */
             text-decoration: none; /* 밑줄 제거 */
        }
        #diff-container del {
             background-color: #ffe6e6; /* 연한 빨간색 */
        }
        .button-container { /* 버튼 정렬용 컨테이너 */
            display: flex;
            gap: 10px; /* 버튼 사이 간격 */
            margin-bottom: 15px;
        }
    </style>
</head>

<body class="ms-font-m ms-welcome ms-Fabric">
    <!-- 헤더는 그대로 유지 -->
    <header class="ms-welcome__header ms-bgColor-neutralLighter">
        <img width="90" height="90" src="../../assets/logo-filled.png" alt="Contoso" title="Contoso" />
        <h1 class="ms-font-su">Content Assistant</h1> <!-- 헤더 타이틀 변경 -->
    </header>

    <!-- 사이드로딩 메시지 섹션 (기존) -->
    <section id="sideload-msg" class="ms-welcome__main">
        <h2 class="ms-font-xl">Please <a target="_blank" href="https://learn.microsoft.com/office/dev/add-ins/testing/test-debug-office-add-ins#sideload-an-office-add-in-for-testing">sideload</a> your add-in to see app body.</h2>
    </section>

    <!-- 메인 앱 본문 (기본으로 숨겨짐) -->
    <main id="app-body" class="ms-welcome__main" style="display: none;">

        <h2 class="ms-font-xl">Proposed Changes</h2>
        <p class="ms-font-m">Review the changes below proposed by the assistant.</p>

        <!-- Diff 결과를 표시할 컨테이너 -->
        <div id="diff-container">
            <!-- Diff 결과 HTML이 JavaScript에 의해 여기에 삽입됩니다 -->
        </div>

        <!-- 수락/거부 버튼 컨테이너 -->
        <div class="button-container">
             <!-- 수락/거부 버튼 (초기에는 숨김) -->
            <button class="ms-Button ms-Button--primary" id="accept-patch" style="display: none;">Accept Changes</button>
            <button class="ms-Button" id="reject-patch" style="display: none;">Reject Changes</button>
        </div>

        <hr> <!-- 구분선 -->

        <p id="status-message">Waiting for commands from MCP server...</p> <!-- 상태 메시지 영역 -->

        <!-- 기존 샘플 실행 버튼 (필요하다면 유지, 아니면 삭제) -->
        <!-- <div role="button" id="run" class="ms-welcome__action ms-Button ms-Button--hero ms-font-xl">
            <span class="ms-Button-label">Run Sample</span>
        </div> -->

    </main>

    <!-- diff-match-patch 라이브러리 로드 (CDN 사용 예시) -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/diff_match_patch/20121119/diff_match_patch.js"></script>
    <!-- json-merge-patch 라이브러리 로드 (필요시, 예: cdnjs) -->
    <!-- <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/json-merge-patch/1.0.0/json-merge-patch.min.js"></script> -->

    <!-- Add-in 로직 스크립트 (가장 마지막에 로드) -->
    <script type="text/javascript" src="taskpane.js"></script>
</body>

</html>